(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e,n){for(var o=0;o<n.length;o++){var r=n[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,i=function(e,n){if("object"!==t(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,"string");if("object"!==t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===t(i)?i:String(i)),r)}var i}var n,o=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._form=n,this._submit=n.querySelector(e.buttonSelector),this._inputList=Array.from(n.querySelectorAll(e.inputSelector)),this._error=e.errorClass,this._buttonDisabled=e.buttonDisabledClass}var n,o;return n=t,(o=[{key:"_showInputError",value:function(t,e){var n=this._form.querySelector("#".concat(t.id,"_error"));n.classList.add(this._error),n.textContent=e}},{key:"_hideInputError",value:function(t){var e=this._form.querySelector("#".concat(t.id,"_error"));e.classList.add(this._error),e.textContent=""}},{key:"_validate",value:function(t){t.validity.valid?this._hideInputError(t):this._showInputError(t,t.validationMessage)}},{key:"_enableSubmitButton",value:function(){this._submit.classList.remove(this._buttonDisabled),this._submit.disabled=!1}},{key:"disableSubmitButton",value:function(){this._submit.classList.add(this._buttonDisabled),this._submit.disabled=!0}},{key:"_hasInvalidInput",value:function(t){return t.some((function(t){return!t.validity.valid}))}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput(this._inputList)?this.disableSubmitButton():(this._submit.removeAttribute("disabled"),this._submit.classList.remove(this._buttonDisabled))}},{key:"_setEventListeners",value:function(){var t=this;this._inputList.forEach((function(e){e.addEventListener("input",(function(){t._validate(e),t._toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._form.addEventListener("submit",(function(t){t.preventDefault()})),this._setEventListeners()}}])&&e(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),t}(),r=document.querySelector(".tasks"),i=document.querySelector(".todo__form"),a=document.querySelector(".todo__input"),s=i.querySelector(".todo__button"),u=document.querySelector(".header__input"),l=document.querySelector(".header__form"),c=[],_=new o({errorClass:"todo__error_visibility",buttonDisabledClass:"todo__button_disabled",inputSelector:".todo__input",buttonSelector:".todo__button"},i);function d(t){var e=t.target.closest(".task").cloneNode(!0);e.classList.add("task__clone_visible"),e.querySelector(".task__copy").classList.add("task__copy_visible"),e.querySelector(".task__element-change").classList.add("element__change_no-visible");var n=e.querySelector(".task__text").textContent;n+="(copy)",c.push(n),f(),r.append(e)}function v(t){var e=t.target.closest(".task"),n=e.querySelector(".task__text").textContent;c=c.filter((function(t){return t!==n})),localStorage.removeItem("initialItem",JSON.stringify(c)),f(),e.remove()}function y(t){var e=t.target.closest(".task").querySelector(".task__text");n=e,a.value=e.textContent,s.textContent="Change",f()}function b(t){var e=document.querySelector("#template").content.cloneNode(!0);e.querySelector(".task__text").textContent=t;var n=e.querySelector(".task__button_type_delete"),o=e.querySelector(".task__button_type_change"),i=e.querySelector(".task__button_type_copy");n.addEventListener("click",v),o.addEventListener("click",y),i.addEventListener("click",d),r.prepend(e)}function f(){localStorage.setItem("initialItem",JSON.stringify(c))}_.enableValidation(),(c=JSON.parse(localStorage.getItem("initialItem"))).forEach((function(t){b(t)})),f(),l.addEventListener("submit",(function(t){var e;t.preventDefault(),(e=u).addEventListener("keyup",(function(){var t=e.value.toUpperCase();document.querySelectorAll(".task").forEach((function(e){e.textContent.toUpperCase().indexOf(t)>-1?e.style.display="":e.style.display="none"}))}))})),i.addEventListener("submit",(function(t){(function(t){t.preventDefault();var e=a.value;n?(n.textContent=a.value,s.textContent="Submit"):b(e),n=null,a.value=null,c.push(e),f()})(t),_.disableSubmitButton()}))})();